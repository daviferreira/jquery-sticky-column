(function(e,t,n){"use strict";function u(t,n){this.options=e.extend({},s,n),this.defaults=s,this.name=r,this.root=e(t),this.init()}var r="stickySidebar",i=t.document,s={sidebar:".sidebar",content:".content",tolerance:110},o={position:"",top:""};u.prototype.init=function(){var n=this;this.sidebar=this.root.find(this.options.sidebar),this.content=this.root.find(this.options.content),this.lastScrollTop=0,this.canBeSticky()===!0&&e(t).bind("scroll.sticky_sidebar",function(){n.setScrollDirection().setBoundaries().positionSidebar()})},u.prototype.canBeSticky=function(){return this.sidebar.height()<this.content.height()&&this.sidebar.height()>e(t).height()},u.prototype.setBoundaries=function(){var n=this.content.offset().top,r=this.content.outerHeight();return this.boundaries={contentTop:n,contentBottom:n+r,contentHeight:r,sidebarHeight:this.sidebar.outerHeight(),windowHeight:e(t).height()},this},u.prototype.positionSidebar=function(){return this.lastScrollTop>this.boundaries.contentTop&&this.lastScrollTop<this.boundaries.contentBottom?this[this.scrollDirection==="DOWN"?"scrollDown":"scrollUp"]():this.lastScrollTop<this.boundaries.contentTop&&this.sidebar.css("top","").removeClass("top-fixed"),this},u.prototype.scrollDown=function(){var e=this.lastScrollTop+this.boundaries.windowHeight,t;this.sidebar.hasClass("top-fixed")&&(t=this.sidebar.offset().top-this.boundaries.contentTop,this.sidebar.removeClass("top-fixed").css({position:"absolute",top:t}).addClass("scrolling-down")),this.sidebar.hasClass("scrolling-down")?e>this.sidebar.offset().top+this.boundaries.sidebarHeight&&this.sidebar.css(o).addClass("bottom-fixed").removeClass("scrolling-down"):e>this.boundaries.contentBottom?this.sidebar.removeClass("bottom-fixed").css({position:"absolute",top:this.boundaries.contentHeight-this.boundaries.sidebarHeight}):e+this.options.tolerance>this.boundaries.sidebarHeight+this.boundaries.contentTop&&this.sidebar.css(o).removeClass("top-fixed").addClass("bottom-fixed")},u.prototype.scrollUp=function(){this.sidebar.hasClass("bottom-fixed")&&this.sidebar.css({position:"absolute",top:this.sidebar.offset().top-this.boundaries.contentTop}).removeClass("bottom-fixed").addClass("scrolling-up"),this.sidebar.hasClass("scrolling-up")?this.lastScrollTop<this.sidebar.offset().top&&this.sidebar.css(o).addClass("top-fixed").removeClass("scrolling-up"):this.lastScrollTop<this.boundaries.contentTop?this.sidebar.css("position","").removeClass("top-fixed"):this.lastScrollTop-this.options.tolerance<this.boundaries.contentBottom-this.boundaries.sidebarHeight&&this.sidebar.css(o).removeClass("bottom-fixed").addClass("top-fixed")},u.prototype.setScrollDirection=function(){var n=e(t).scrollTop();return this.scrollDirection=n>this.lastScrollTop?"DOWN":"UP",this.lastScrollTop=n,this},e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new u(this,t))})}})(jQuery,window);