/*! jQuery Sticky Sidebar plugin - v0.1.0 - 2012-10-26
* https://github.com/daviferreira/jquery_sticky_sidebar/
* Copyright (c) 2012 Davi Ferreira; Licensed THE BEER-WARE LICENSE */
(function(e,t,n){"use strict";function o(t,n){this.options=e.extend({},s,n),this.defaults=s,this.name=r,this.root=e(t),this.init()}var r="stickySidebar",i=t.document,s={sidebar:".sidebar",content:".content"};o.prototype.init=function(){var n=this;this.sidebar=this.root.find(this.options.sidebar),this.content=this.root.find(this.options.content),this.lastScrollTop=0,e(t).bind("scroll.sidebar",function(){n.setScrollDirection().setBoundaries().positionSidebar()})},o.prototype.setBoundaries=function(){var n=this.content.offset().top,r=this.content.outerHeight();return this.boundaries={contentTop:n,contentBottom:n+r,contentHeight:r,sidebarHeight:this.sidebar.outerHeight(),windowHeight:e(t).height()},this},o.prototype.positionSidebar=function(){return this.lastScrollTop>this.boundaries.contentTop&&this.lastScrollTop<this.boundaries.contentBottom?this[this.scrollDirection==="DOWN"?"scrollDown":"scrollUp"]():this.lastScrollTop<this.boundaries.contentTop&&this.sidebar.css("top","").removeClass("top-fixed"),this},o.prototype.scrollDown=function(){var e=this.lastScrollTop+this.boundaries.windowHeight,t;this.sidebar.hasClass("top-fixed")&&(t=this.sidebar.offset().top-this.boundaries.contentTop,this.sidebar.removeClass("top-fixed").css({top:t}).addClass("scrolling-down")),this.sidebar.hasClass("scrolling-down")?e>this.sidebar.offset().top+this.boundaries.sidebarHeight&&this.sidebar.css({position:"",top:""}).addClass("bottom-fixed").removeClass("scrolling-down"):e>this.boundaries.contentBottom?this.sidebar.removeClass("bottom-fixed").css({position:"absolute",top:this.boundaries.contentHeight-this.boundaries.sidebarHeight}):e>this.boundaries.sidebarHeight+this.boundaries.contentTop&&this.sidebar.css({position:"",top:""}).removeClass("top-fixed").addClass("bottom-fixed")},o.prototype.scrollUp=function(){this.sidebar.hasClass("bottom-fixed")&&this.sidebar.css({position:"absolute",top:this.sidebar.offset().top-this.boundaries.contentTop}).removeClass("bottom-fixed").addClass("scrolling-up"),this.sidebar.hasClass("scrolling-up")?this.lastScrollTop<this.sidebar.offset().top&&this.sidebar.css({position:"",top:""}).addClass("top-fixed").removeClass("scrolling-up"):this.lastScrollTop<this.boundaries.contentTop?this.sidebar.css("position","").removeClass("top-fixed"):this.lastScrollTop<this.boundaries.contentBottom-this.boundaries.sidebarHeight&&this.sidebar.css({position:"",top:""}).removeClass("bottom-fixed").addClass("top-fixed")},o.prototype.setScrollDirection=function(){var n=e(t).scrollTop();return this.scrollDirection=n>this.lastScrollTop?"DOWN":"UP",this.lastScrollTop=n,this},e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new o(this,t))})}})(jQuery,window);